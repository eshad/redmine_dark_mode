/**
 * Redmine Dark Mode Plugin
 * Dark mode styles for Redmine
 */

/* CSS Variables for Dark Mode */
html.dark-mode {
  --dm-bg-primary: #1a1a2e;
  --dm-bg-secondary: #16213e;
  --dm-bg-tertiary: #0f3460;
  --dm-bg-card: #1f1f3d;
  --dm-bg-hover: #2a2a4a;
  --dm-bg-input: #252542;
  --dm-text-primary: #e4e4e7;
  --dm-text-secondary: #a1a1aa;
  --dm-text-muted: #71717a;
  --dm-border: #3f3f5a;
  --dm-border-light: #2a2a4a;
  --dm-link: #60a5fa;
  --dm-link-hover: #93c5fd;
  --dm-accent: #818cf8;
  --dm-success: #34d399;
  --dm-warning: #fbbf24;
  --dm-error: #f87171;
  --dm-header-bg: #0f172a;
  --dm-header-gradient: linear-gradient(180deg, #1e293b 30%, #0f172a);
  --dm-menu-bg: #1e293b;
  --dm-menu-active: #3b82f6;
  --dm-sidebar-bg: #1f1f3d;
  --dm-table-header: #252542;
  --dm-table-row-odd: #1a1a2e;
  --dm-table-row-even: #1f1f3d;
  --dm-table-row-hover: #2a2a4a;
}

/* Base styles */
html.dark-mode,
html.dark-mode body {
  background-color: var(--dm-bg-primary) !important;
  color: var(--dm-text-primary) !important;
}

/* Wrapper and main content */
html.dark-mode #wrapper {
  background: var(--dm-bg-primary) !important;
}

html.dark-mode #content {
  background-color: var(--dm-bg-primary) !important;
  color: var(--dm-text-primary) !important;
}

/* Top menu */
html.dark-mode #top-menu {
  background: var(--dm-header-bg) !important;
  border-bottom: 1px solid var(--dm-border) !important;
}

html.dark-mode #top-menu a {
  color: var(--dm-text-primary) !important;
}

html.dark-mode #top-menu a:hover {
  color: var(--dm-link) !important;
}

/* Header */
html.dark-mode #header {
  background: var(--dm-header-gradient) !important;
  border-bottom: 1px solid var(--dm-border) !important;
}

html.dark-mode #header a,
html.dark-mode #header h1 {
  color: var(--dm-text-primary) !important;
}

/* Main menu */
html.dark-mode #main-menu {
  background: transparent !important;
}

html.dark-mode #main-menu li a {
  color: var(--dm-text-primary) !important;
}

html.dark-mode #main-menu li a:hover {
  background: var(--dm-menu-bg) !important;
  color: var(--dm-text-primary) !important;
}

html.dark-mode #main-menu li a.selected,
html.dark-mode #main-menu li a.selected:hover {
  background: var(--dm-bg-primary) !important;
  color: var(--dm-text-primary) !important;
}

html.dark-mode #main-menu .menu-children {
  background-color: var(--dm-bg-card) !important;
  border-color: var(--dm-border) !important;
}

html.dark-mode #main-menu .menu-children li a {
  background-color: var(--dm-bg-card) !important;
  color: var(--dm-text-primary) !important;
}

html.dark-mode #main-menu .menu-children li a:hover {
  background-color: var(--dm-menu-active) !important;
  color: #fff !important;
}

/* Sidebar */
html.dark-mode #sidebar {
  background: var(--dm-sidebar-bg) !important;
  border-left: 1px solid var(--dm-border) !important;
  color: var(--dm-text-primary) !important;
}

html.dark-mode #sidebar h3 {
  color: var(--dm-text-primary) !important;
}

html.dark-mode #sidebar a {
  color: var(--dm-link) !important;
}

html.dark-mode #sidebar a:hover {
  color: var(--dm-link-hover) !important;
}

html.dark-mode #sidebar a.selected {
  background-color: var(--dm-menu-active) !important;
  color: #fff !important;
}

html.dark-mode #sidebar hr {
  background: var(--dm-border) !important;
}

html.dark-mode #sidebar-switch-button:hover {
  background-color: var(--dm-bg-hover) !important;
}

html.dark-mode #sidebar-switch-button svg {
  stroke: var(--dm-text-primary) !important;
}

/* Footer */
html.dark-mode #footer {
  background: var(--dm-bg-secondary) !important;
  border-top: 1px solid var(--dm-border) !important;
  color: var(--dm-text-muted) !important;
}

html.dark-mode #footer a {
  color: var(--dm-link) !important;
}

/* Headings */
html.dark-mode h1,
html.dark-mode h2,
html.dark-mode h3,
html.dark-mode h4,
html.dark-mode h5,
html.dark-mode h6,
html.dark-mode #content h1,
html.dark-mode #content h2,
html.dark-mode #content h3,
html.dark-mode #content h4,
html.dark-mode #content h5,
html.dark-mode #content h6 {
  color: var(--dm-text-primary) !important;
}

html.dark-mode h4 {
  border-bottom-color: var(--dm-border) !important;
}

/* Links */
html.dark-mode a,
html.dark-mode a:link,
html.dark-mode a:visited {
  color: var(--dm-link) !important;
}

html.dark-mode a:hover,
html.dark-mode a:active {
  color: var(--dm-link-hover) !important;
}

html.dark-mode a.issue.closed,
html.dark-mode a.project.closed,
html.dark-mode a.user.locked {
  color: var(--dm-text-muted) !important;
}

html.dark-mode a.user.user-mention {
  background-color: var(--dm-bg-tertiary) !important;
}

/* Tables */
html.dark-mode table.list,
html.dark-mode .table-list {
  border-top-color: var(--dm-border) !important;
  border-bottom-color: var(--dm-border) !important;
}

html.dark-mode table.list th,
html.dark-mode .table-list-header {
  background-color: var(--dm-table-header) !important;
  color: var(--dm-text-primary) !important;
  border-bottom-color: var(--dm-border) !important;
}

html.dark-mode table.list td {
  border-top-color: var(--dm-border-light) !important;
  color: var(--dm-text-primary) !important;
}

html.dark-mode table.list:not(.odd-even) tbody tr:nth-child(odd),
html.dark-mode .odd {
  background-color: var(--dm-table-row-odd) !important;
}

html.dark-mode table.list:not(.odd-even) tbody tr:nth-child(even),
html.dark-mode .even {
  background-color: var(--dm-table-row-even) !important;
}

html.dark-mode table.list:not(.odd-even) tbody tr:nth-child(odd):hover,
html.dark-mode table.list:not(.odd-even) tbody tr:nth-child(even):hover,
html.dark-mode .odd:hover,
html.dark-mode .even:hover {
  background-color: var(--dm-table-row-hover) !important;
}

html.dark-mode tr.group td {
  background-color: var(--dm-bg-primary) !important;
  border-bottom-color: var(--dm-border) !important;
  color: var(--dm-text-primary) !important;
}

html.dark-mode tr.group span.totals {
  color: var(--dm-text-muted) !important;
}

html.dark-mode tr.group span.totals .value {
  color: var(--dm-text-secondary) !important;
}

html.dark-mode table td {
  color: var(--dm-text-primary) !important;
}

html.dark-mode tr.issue-report-detailed.total,
html.dark-mode tr.issue-report.total {
  border-top-color: var(--dm-border) !important;
}

/* Forms and inputs */
html.dark-mode input[type="text"],
html.dark-mode input[type="password"],
html.dark-mode input[type="email"],
html.dark-mode input[type="number"],
html.dark-mode input[type="search"],
html.dark-mode input[type="url"],
html.dark-mode input[type="date"],
html.dark-mode input[type="datetime-local"],
html.dark-mode input[type="time"],
html.dark-mode textarea,
html.dark-mode select {
  background-color: var(--dm-bg-input) !important;
  color: var(--dm-text-primary) !important;
  border: 1px solid var(--dm-border) !important;
}

html.dark-mode input[type="text"]:focus,
html.dark-mode input[type="password"]:focus,
html.dark-mode input[type="email"]:focus,
html.dark-mode input[type="number"]:focus,
html.dark-mode input[type="search"]:focus,
html.dark-mode input[type="url"]:focus,
html.dark-mode textarea:focus,
html.dark-mode select:focus {
  border-color: var(--dm-accent) !important;
  outline: none !important;
}

html.dark-mode input::placeholder,
html.dark-mode textarea::placeholder {
  color: var(--dm-text-muted) !important;
}

html.dark-mode select option {
  background-color: var(--dm-bg-card) !important;
  color: var(--dm-text-primary) !important;
}

/* Buttons */
html.dark-mode input[type="submit"],
html.dark-mode input[type="button"],
html.dark-mode button,
html.dark-mode .button {
  background: var(--dm-bg-tertiary) !important;
  color: var(--dm-text-primary) !important;
  border: 1px solid var(--dm-border) !important;
}

html.dark-mode input[type="submit"]:hover,
html.dark-mode input[type="button"]:hover,
html.dark-mode button:hover,
html.dark-mode .button:hover {
  background: var(--dm-menu-active) !important;
  color: #fff !important;
  border-color: var(--dm-menu-active) !important;
}

/* Dropdowns */
html.dark-mode .drdn-content {
  background-color: var(--dm-bg-card) !important;
  border-color: var(--dm-border) !important;
  color: var(--dm-text-primary) !important;
}

html.dark-mode .drdn-items > * {
  border-color: var(--dm-bg-card) !important;
  color: var(--dm-text-primary) !important;
}

html.dark-mode .drdn-items > span {
  color: var(--dm-text-muted) !important;
}

html.dark-mode .contextual .drdn-items > a:hover {
  background-color: var(--dm-bg-hover) !important;
  border-color: var(--dm-accent) !important;
  color: var(--dm-text-primary) !important;
}

html.dark-mode #project-jump .drdn-trigger {
  background-color: var(--dm-bg-input) !important;
  border-color: var(--dm-border) !important;
  color: var(--dm-text-primary) !important;
}

html.dark-mode #project-jump .drdn-items > * {
  color: var(--dm-text-primary) !important;
}

html.dark-mode #project-jump .drdn-items > a:hover {
  background-color: var(--dm-menu-active) !important;
  color: #fff !important;
}

html.dark-mode div + .drdn-items {
  border-top-color: var(--dm-border) !important;
}

/* Quick search */
html.dark-mode #quick-search #q {
  background-color: var(--dm-bg-input) !important;
  border-color: var(--dm-border) !important;
  color: var(--dm-text-primary) !important;
}

/* Login form */
html.dark-mode #login-form {
  background-color: var(--dm-bg-card) !important;
  border-color: var(--dm-border) !important;
}

html.dark-mode #login-form label {
  color: var(--dm-text-primary) !important;
}

/* Modal */
html.dark-mode div.modal {
  background: var(--dm-bg-card) !important;
  color: var(--dm-text-primary) !important;
}

/* Flash messages */
html.dark-mode #flash_notice,
html.dark-mode .flash.notice {
  background-color: rgba(52, 211, 153, 0.15) !important;
  border: 1px solid var(--dm-success) !important;
  color: var(--dm-success) !important;
}

html.dark-mode #flash_error,
html.dark-mode .flash.error {
  background-color: rgba(248, 113, 113, 0.15) !important;
  border: 1px solid var(--dm-error) !important;
  color: var(--dm-error) !important;
}

html.dark-mode #flash_warning,
html.dark-mode .flash.warning {
  background-color: rgba(251, 191, 36, 0.15) !important;
  border: 1px solid var(--dm-warning) !important;
  color: var(--dm-warning) !important;
}

/* Box/fieldsets */
html.dark-mode fieldset,
html.dark-mode .box {
  background-color: var(--dm-bg-card) !important;
  border: 1px solid var(--dm-border) !important;
  color: var(--dm-text-primary) !important;
}

html.dark-mode fieldset legend {
  background-color: var(--dm-bg-primary) !important;
  color: var(--dm-text-primary) !important;
}

html.dark-mode .box {
  background-color: var(--dm-bg-card) !important;
}

/* Tabs */
html.dark-mode .tabs ul {
  border-bottom-color: var(--dm-border) !important;
}

html.dark-mode .tabs ul li a {
  background-color: var(--dm-bg-secondary) !important;
  border-color: var(--dm-border) !important;
  color: var(--dm-text-primary) !important;
}

html.dark-mode .tabs ul li a:hover {
  background-color: var(--dm-bg-hover) !important;
}

html.dark-mode .tabs ul li a.selected {
  background-color: var(--dm-bg-primary) !important;
  border-bottom-color: var(--dm-bg-primary) !important;
}

/* Wiki and text content */
html.dark-mode .wiki {
  color: var(--dm-text-primary) !important;
}

html.dark-mode .wiki h1,
html.dark-mode .wiki h2,
html.dark-mode .wiki h3,
html.dark-mode .wiki h4,
html.dark-mode .wiki h5,
html.dark-mode .wiki h6 {
  color: var(--dm-text-primary) !important;
}

html.dark-mode pre,
html.dark-mode code {
  background-color: var(--dm-bg-secondary) !important;
  color: var(--dm-text-primary) !important;
  border-color: var(--dm-border) !important;
}

html.dark-mode pre code {
  background-color: transparent !important;
}

html.dark-mode blockquote {
  border-left-color: var(--dm-accent) !important;
  color: var(--dm-text-secondary) !important;
  background-color: var(--dm-bg-secondary) !important;
}

/* Issues */
html.dark-mode .issue {
  color: var(--dm-text-primary) !important;
}

html.dark-mode .issue .attributes,
html.dark-mode .issue .attribute {
  color: var(--dm-text-primary) !important;
}

html.dark-mode div.issue div.subject h3 {
  color: var(--dm-text-primary) !important;
}

html.dark-mode .issue .next-prev-links a {
  color: var(--dm-link) !important;
}

html.dark-mode tr.issue td.checkbox + td.id + td a {
  color: var(--dm-link) !important;
}

/* Journals/history */
html.dark-mode #issue-changesets,
html.dark-mode .journal {
  color: var(--dm-text-primary) !important;
}

html.dark-mode .journal .wiki {
  color: var(--dm-text-primary) !important;
}

html.dark-mode .journal-link {
  color: var(--dm-text-muted) !important;
}

html.dark-mode #issue-changesets div.changeset:nth-child(odd),
html.dark-mode div.journal:nth-child(odd) {
  background-color: var(--dm-table-row-odd) !important;
}

html.dark-mode #issue-changesets div.changeset:nth-child(even),
html.dark-mode div.journal:nth-child(even) {
  background-color: var(--dm-table-row-even) !important;
}

/* Calendar */
html.dark-mode table.cal {
  border-color: var(--dm-border) !important;
}

html.dark-mode table.cal th {
  background-color: var(--dm-table-header) !important;
  color: var(--dm-text-primary) !important;
}

html.dark-mode table.cal td {
  background-color: var(--dm-bg-primary) !important;
  border-color: var(--dm-border) !important;
}

html.dark-mode table.cal td.odd {
  background-color: var(--dm-bg-secondary) !important;
}

html.dark-mode table.cal td.today {
  background-color: var(--dm-bg-tertiary) !important;
}

/* Gantt */
html.dark-mode .gantt_hdr {
  background-color: var(--dm-table-header) !important;
  border-color: var(--dm-border) !important;
  color: var(--dm-text-primary) !important;
}

html.dark-mode .gantt_subjects {
  background-color: var(--dm-bg-primary) !important;
}

/* Context menu */
html.dark-mode #context-menu {
  background-color: var(--dm-bg-card) !important;
  border-color: var(--dm-border) !important;
}

html.dark-mode #context-menu li {
  color: var(--dm-text-primary) !important;
}

html.dark-mode #context-menu li a {
  color: var(--dm-text-primary) !important;
}

html.dark-mode #context-menu li a:hover {
  background-color: var(--dm-menu-active) !important;
  color: #fff !important;
}

html.dark-mode #context-menu li.folder ul {
  background-color: var(--dm-bg-card) !important;
  border-color: var(--dm-border) !important;
}

/* Pagination */
html.dark-mode .pagination {
  color: var(--dm-text-secondary) !important;
}

html.dark-mode .pagination a {
  color: var(--dm-link) !important;
}

html.dark-mode .pagination span.current {
  background-color: var(--dm-menu-active) !important;
  color: #fff !important;
}

/* Progress bar */
html.dark-mode table.progress {
  background-color: var(--dm-bg-secondary) !important;
}

html.dark-mode table.progress td.closed {
  background-color: var(--dm-success) !important;
}

html.dark-mode table.progress td.done {
  background-color: var(--dm-accent) !important;
}

/* Tooltips */
html.dark-mode .ui-tooltip {
  background-color: var(--dm-bg-card) !important;
  border-color: var(--dm-border) !important;
  color: var(--dm-text-primary) !important;
}

/* jQuery UI */
html.dark-mode .ui-widget {
  color: var(--dm-text-primary) !important;
}

html.dark-mode .ui-widget-content {
  background-color: var(--dm-bg-card) !important;
  border-color: var(--dm-border) !important;
  color: var(--dm-text-primary) !important;
}

html.dark-mode .ui-widget-header {
  background: var(--dm-bg-tertiary) !important;
  border-color: var(--dm-border) !important;
  color: var(--dm-text-primary) !important;
}

html.dark-mode .ui-state-default,
html.dark-mode .ui-widget-content .ui-state-default {
  background: var(--dm-bg-secondary) !important;
  border-color: var(--dm-border) !important;
  color: var(--dm-text-primary) !important;
}

html.dark-mode .ui-state-hover,
html.dark-mode .ui-widget-content .ui-state-hover {
  background: var(--dm-bg-hover) !important;
  color: var(--dm-text-primary) !important;
}

html.dark-mode .ui-state-active,
html.dark-mode .ui-widget-content .ui-state-active {
  background: var(--dm-menu-active) !important;
  color: #fff !important;
}

html.dark-mode .ui-state-highlight {
  background: var(--dm-bg-tertiary) !important;
  color: var(--dm-text-primary) !important;
}

/* Autocomplete */
html.dark-mode .ui-autocomplete {
  background-color: var(--dm-bg-card) !important;
  border-color: var(--dm-border) !important;
}

html.dark-mode .ui-menu-item {
  color: var(--dm-text-primary) !important;
}

html.dark-mode .ui-menu-item:hover,
html.dark-mode .ui-menu-item.ui-state-focus {
  background-color: var(--dm-menu-active) !important;
  color: #fff !important;
}

/* Datepicker */
html.dark-mode .ui-datepicker {
  background-color: var(--dm-bg-card) !important;
  border-color: var(--dm-border) !important;
}

html.dark-mode .ui-datepicker td {
  background-color: var(--dm-bg-primary) !important;
}

html.dark-mode .ui-datepicker td a {
  color: var(--dm-text-primary) !important;
}

html.dark-mode .ui-datepicker td.ui-datepicker-today {
  background-color: var(--dm-bg-tertiary) !important;
}

/* Admin menu */
html.dark-mode #admin-menu a {
  color: var(--dm-link) !important;
}

html.dark-mode #admin-menu a.selected {
  background-color: var(--dm-menu-active) !important;
  color: #fff !important;
}

/* Settings tabs */
html.dark-mode .settings.tabs ul li a {
  background-color: var(--dm-bg-secondary) !important;
  border-color: var(--dm-border) !important;
  color: var(--dm-text-primary) !important;
}

/* Attachments */
html.dark-mode .attachments {
  color: var(--dm-text-primary) !important;
}

html.dark-mode .attachments a {
  color: var(--dm-link) !important;
}

/* Text formatting toolbar */
html.dark-mode .jstEditor,
html.dark-mode .jstElements {
  background-color: var(--dm-bg-secondary) !important;
  border-color: var(--dm-border) !important;
}

html.dark-mode .jstElements button {
  background-color: var(--dm-bg-secondary) !important;
  color: var(--dm-text-primary) !important;
}

html.dark-mode .jstElements button:hover {
  background-color: var(--dm-bg-hover) !important;
}

/* Queries */
html.dark-mode #query_form_content {
  color: var(--dm-text-primary) !important;
}

html.dark-mode .query-columns label {
  color: var(--dm-text-primary) !important;
}

/* Splitcontentleft/right */
html.dark-mode .splitcontentleft,
html.dark-mode .splitcontentright {
  color: var(--dm-text-primary) !important;
}

/* Version info */
html.dark-mode .version-overview {
  color: var(--dm-text-primary) !important;
}

/* SVG icons - but not in toolbar buttons */
html.dark-mode svg:not(.jstElements svg) {
  stroke: var(--dm-text-primary) !important;
}

html.dark-mode a svg {
  stroke: var(--dm-link) !important;
}

html.dark-mode a:hover svg {
  stroke: var(--dm-link-hover) !important;
}

/* Keep toolbar button SVGs with original dark strokes */
html.dark-mode .jstElements button svg {
  stroke: #333 !important;
}

/* Attributes section on issues */
html.dark-mode .attributes {
  color: var(--dm-text-primary) !important;
}

html.dark-mode .attribute .label {
  color: var(--dm-text-secondary) !important;
}

html.dark-mode .attribute .value {
  color: var(--dm-text-primary) !important;
}

/* Description */
html.dark-mode .description {
  color: var(--dm-text-primary) !important;
}

/* Private notes */
html.dark-mode .private-notes {
  background-color: rgba(251, 191, 36, 0.1) !important;
  border-color: var(--dm-warning) !important;
}

/* Labels */
html.dark-mode label {
  color: var(--dm-text-primary) !important;
}

/* Priority colors - keep them visible */
html.dark-mode .priority-highest,
html.dark-mode .priority-high {
  color: var(--dm-error) !important;
}

html.dark-mode .priority-low,
html.dark-mode .priority-lowest {
  color: var(--dm-text-muted) !important;
}

/* Status colors */
html.dark-mode .status-closed {
  color: var(--dm-success) !important;
}

/* Tracker colors - make them visible */
html.dark-mode span.icon-issue {
  color: var(--dm-text-primary) !important;
}

/* Query totals */
html.dark-mode .query-totals {
  color: var(--dm-text-secondary) !important;
}

html.dark-mode .query-totals .value {
  color: var(--dm-text-primary) !important;
}

/* News and activity */
html.dark-mode dl.news dt,
html.dark-mode .news h3 {
  color: var(--dm-text-primary) !important;
}

/* Activity list */
html.dark-mode #activity dt,
html.dark-mode .activity dt {
  color: var(--dm-text-secondary) !important;
}

html.dark-mode #activity dd,
html.dark-mode .activity dd {
  color: var(--dm-text-primary) !important;
}

/* Message boards */
html.dark-mode .message {
  color: var(--dm-text-primary) !important;
}

html.dark-mode .reply {
  background-color: var(--dm-bg-secondary) !important;
  border-color: var(--dm-border) !important;
}

html.dark-mode #replies .reply:target h4.reply-header {
  background-color: var(--dm-bg-tertiary) !important;
}

/* Project list */
html.dark-mode ul.projects li {
  color: var(--dm-text-primary) !important;
}

/* Toggle button styles */
html.dark-mode #dark-mode-toggle svg {
  stroke: var(--dm-text-primary) !important;
}

/* Loading spinner */
html.dark-mode #ajax-indicator {
  background-color: rgba(0, 0, 0, 0.7) !important;
}

html.dark-mode #ajax-indicator span {
  background-color: var(--dm-bg-card) !important;
  color: var(--dm-text-primary) !important;
}

/* Help tooltips */
html.dark-mode .tooltip {
  color: var(--dm-text-primary) !important;
}

html.dark-mode .tip {
  background-color: var(--dm-bg-card) !important;
  border-color: var(--dm-border) !important;
  color: var(--dm-text-primary) !important;
}

/* Diff view */
html.dark-mode .diff_in {
  background-color: rgba(52, 211, 153, 0.2) !important;
}

html.dark-mode .diff_out {
  background-color: rgba(248, 113, 113, 0.2) !important;
}

/* Repository/files view */
html.dark-mode .filecontent {
  background-color: var(--dm-bg-secondary) !important;
  color: var(--dm-text-primary) !important;
}

html.dark-mode .autoscroll {
  background-color: var(--dm-bg-primary) !important;
}

/* Line numbers */
html.dark-mode .syntaxhl .line-numbers {
  background-color: var(--dm-bg-secondary) !important;
  color: var(--dm-text-muted) !important;
}

/* Roadmap */
html.dark-mode .roadmap .wiki {
  color: var(--dm-text-primary) !important;
}

/* Related issues */
html.dark-mode .relations {
  color: var(--dm-text-primary) !important;
}

/* Watchers */
html.dark-mode .watchers {
  color: var(--dm-text-primary) !important;
}

/* Time entries */
html.dark-mode .time-entries {
  color: var(--dm-text-primary) !important;
}

/* User profiles */
html.dark-mode .user.box {
  background-color: var(--dm-bg-card) !important;
}

/* Gravatars - add subtle border */
html.dark-mode img.gravatar {
  border: 1px solid var(--dm-border) !important;
}

/* Optgroup in selects */
html.dark-mode optgroup {
  background-color: var(--dm-bg-secondary) !important;
  color: var(--dm-text-primary) !important;
}

/* Disabled inputs */
html.dark-mode input:disabled,
html.dark-mode select:disabled,
html.dark-mode textarea:disabled {
  background-color: var(--dm-bg-secondary) !important;
  color: var(--dm-text-muted) !important;
  opacity: 0.7;
}

/* Checkboxes and radios - use accent color */
html.dark-mode input[type="checkbox"],
html.dark-mode input[type="radio"] {
  accent-color: var(--dm-accent) !important;
}

/* HR elements */
html.dark-mode hr {
  border-color: var(--dm-border) !important;
  background-color: var(--dm-border) !important;
}

/* Make sure text in specific places is visible */
html.dark-mode p,
html.dark-mode span,
html.dark-mode div,
html.dark-mode li,
html.dark-mode td,
html.dark-mode th {
  color: inherit;
}

/* ============================================
   TEXT EDITOR TOOLBAR (jstoolbar) - FIXED
   ============================================ */
html.dark-mode .jstEditor {
  background-color: var(--dm-bg-secondary) !important;
  border: 1px solid var(--dm-border) !important;
}

html.dark-mode .jstElements {
  background-color: var(--dm-bg-tertiary) !important;
  border-bottom: 1px solid var(--dm-border) !important;
  padding: 4px !important;
}

/* Toolbar buttons base style */
html.dark-mode .jstElements button {
  background-color: var(--dm-bg-hover) !important;
  border: 1px solid var(--dm-border) !important;
  border-radius: 3px !important;
}

html.dark-mode .jstElements button:hover {
  background-color: var(--dm-accent) !important;
  border-color: var(--dm-accent) !important;
}

/* Toolbar icons - exact Redmine icons with white stroke */
html.dark-mode .jstb_strong {
  background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='16' height='16' viewBox='0 0 24 24' fill='none' stroke='%23e4e4e7' stroke-width='2' stroke-linecap='round' stroke-linejoin='round'%3E%3Cpath d='M7 5h6a3.5 3.5 0 0 1 0 7h-6z'/%3E%3Cpath d='M13 12h1a3.5 3.5 0 0 1 0 7h-7v-7'/%3E%3C/svg%3E") !important;
}
html.dark-mode .jstb_em {
  background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='16' height='16' viewBox='0 0 24 24' fill='none' stroke='%23e4e4e7' stroke-width='2' stroke-linecap='round' stroke-linejoin='round'%3E%3Cpath d='M11 5l6 0'/%3E%3Cpath d='M7 19l6 0'/%3E%3Cpath d='M14 5l-4 14'/%3E%3C/svg%3E") !important;
}
html.dark-mode .jstb_ins {
  background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='16' height='16' viewBox='0 0 24 24' fill='none' stroke='%23e4e4e7' stroke-width='2' stroke-linecap='round' stroke-linejoin='round'%3E%3Cpath d='M7 5v5a5 5 0 0 0 10 0v-5'/%3E%3Cpath d='M5 19h14'/%3E%3C/svg%3E") !important;
}
html.dark-mode .jstb_del {
  background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='16' height='16' viewBox='0 0 24 24' fill='none' stroke='%23e4e4e7' stroke-width='2' stroke-linecap='round' stroke-linejoin='round'%3E%3Cpath d='M5 12l14 0'/%3E%3Cpath d='M16 6.5a4 2 0 0 0 -4 -1.5h-1a3.5 3.5 0 0 0 0 7h2a3.5 3.5 0 0 1 0 7h-1.5a4 2 0 0 1 -4 -1.5'/%3E%3C/svg%3E") !important;
}
html.dark-mode .jstb_code {
  background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='16' height='16' viewBox='0 0 24 24' fill='none' stroke='%23e4e4e7' stroke-width='2' stroke-linecap='round' stroke-linejoin='round'%3E%3Cpath d='M18 9a5 5 0 0 0 -5 -5h-2a5 5 0 0 0 -5 5v6a5 5 0 0 0 5 5h2a5 5 0 0 0 5 -5'/%3E%3C/svg%3E") !important;
}
html.dark-mode .jstb_h1 {
  background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='16' height='16' viewBox='0 0 24 24' fill='none' stroke='%23e4e4e7' stroke-width='2' stroke-linecap='round' stroke-linejoin='round'%3E%3Cpath d='M19 18v-8l-2 2'/%3E%3Cpath d='M4 6v12'/%3E%3Cpath d='M12 6v12'/%3E%3Cpath d='M11 18h2'/%3E%3Cpath d='M3 18h2'/%3E%3Cpath d='M4 12h8'/%3E%3Cpath d='M3 6h2'/%3E%3Cpath d='M11 6h2'/%3E%3C/svg%3E") !important;
}
html.dark-mode .jstb_h2 {
  background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='16' height='16' viewBox='0 0 24 24' fill='none' stroke='%23e4e4e7' stroke-width='2' stroke-linecap='round' stroke-linejoin='round'%3E%3Cpath d='M17 12a2 2 0 1 1 4 0c0 .591 -.417 1.318 -.816 1.858l-3.184 4.143l4 0'/%3E%3Cpath d='M4 6v12'/%3E%3Cpath d='M12 6v12'/%3E%3Cpath d='M11 18h2'/%3E%3Cpath d='M3 18h2'/%3E%3Cpath d='M4 12h8'/%3E%3Cpath d='M3 6h2'/%3E%3Cpath d='M11 6h2'/%3E%3C/svg%3E") !important;
}
html.dark-mode .jstb_h3 {
  background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='16' height='16' viewBox='0 0 24 24' fill='none' stroke='%23e4e4e7' stroke-width='2' stroke-linecap='round' stroke-linejoin='round'%3E%3Cpath d='M19 14a2 2 0 1 0 -2 -2'/%3E%3Cpath d='M17 16a2 2 0 1 0 2 -2'/%3E%3Cpath d='M4 6v12'/%3E%3Cpath d='M12 6v12'/%3E%3Cpath d='M11 18h2'/%3E%3Cpath d='M3 18h2'/%3E%3Cpath d='M4 12h8'/%3E%3Cpath d='M3 6h2'/%3E%3Cpath d='M11 6h2'/%3E%3C/svg%3E") !important;
}
html.dark-mode .jstb_ul {
  background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='16' height='16' viewBox='0 0 24 24' fill='none' stroke='%23e4e4e7' stroke-width='2' stroke-linecap='round' stroke-linejoin='round'%3E%3Cpath d='M9 6l11 0'/%3E%3Cpath d='M9 12l11 0'/%3E%3Cpath d='M9 18l11 0'/%3E%3Cpath d='M5 6l0 .01'/%3E%3Cpath d='M5 12l0 .01'/%3E%3Cpath d='M5 18l0 .01'/%3E%3C/svg%3E") !important;
}
html.dark-mode .jstb_ol {
  background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='16' height='16' viewBox='0 0 24 24' fill='none' stroke='%23e4e4e7' stroke-width='2' stroke-linecap='round' stroke-linejoin='round'%3E%3Cpath d='M11 6h9'/%3E%3Cpath d='M11 12h9'/%3E%3Cpath d='M12 18h8'/%3E%3Cpath d='M4 16a2 2 0 1 1 4 0c0 .591 -.5 1 -1 1.5l-3 2.5h4'/%3E%3Cpath d='M6 10v-6l-2 2'/%3E%3C/svg%3E") !important;
}
html.dark-mode .jstb_bq {
  background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='16' height='16' viewBox='0 0 24 24' fill='none' stroke='%23e4e4e7' stroke-width='2' stroke-linecap='round' stroke-linejoin='round'%3E%3Cpath d='M20 6l-11 0'/%3E%3Cpath d='M20 12l-7 0'/%3E%3Cpath d='M20 18l-11 0'/%3E%3Cpath d='M4 8l4 4l-4 4'/%3E%3C/svg%3E") !important;
}
html.dark-mode .jstb_unbq {
  background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='16' height='16' viewBox='0 0 24 24' fill='none' stroke='%23e4e4e7' stroke-width='2' stroke-linecap='round' stroke-linejoin='round'%3E%3Cpath d='M20 6l-7 0'/%3E%3Cpath d='M20 12l-9 0'/%3E%3Cpath d='M20 18l-7 0'/%3E%3Cpath d='M8 8l-4 4l4 4'/%3E%3C/svg%3E") !important;
}
html.dark-mode .jstb_pre::before {
  color: #e4e4e7 !important;
}
html.dark-mode .jstb_precode {
  background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='16' height='16' viewBox='0 0 24 24' fill='none' stroke='%23e4e4e7' stroke-width='2' stroke-linecap='round' stroke-linejoin='round'%3E%3Cpath d='M7 8l-4 4l4 4'/%3E%3Cpath d='M17 8l4 4l-4 4'/%3E%3Cpath d='M14 4l-4 16'/%3E%3C/svg%3E") !important;
}
html.dark-mode .jstb_link {
  background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='16' height='16' viewBox='0 0 24 24' fill='none' stroke='%23e4e4e7' stroke-width='2' stroke-linecap='round' stroke-linejoin='round'%3E%3Cpath d='M15.536 17.586a2.123 2.123 0 0 0 -2.929 0a1.951 1.951 0 0 0 0 2.828c.809 .781 2.12 .781 2.929 0c.809 -.781 -.805 .778 0 0l1.46 -1.41l1.46 -1.419'/%3E%3Cpath d='M15.54 17.582l1.46 1.42l1.46 1.41c.809 .78 -.805 -.779 0 0s2.12 .781 2.929 0a1.951 1.951 0 0 0 0 -2.828a2.123 2.123 0 0 0 -2.929 0'/%3E%3Cpath d='M14 3v4a1 1 0 0 0 1 1h4'/%3E%3Cpath d='M9.5 21h-2.5a2 2 0 0 1 -2 -2v-14a2 2 0 0 1 2 -2h7l5 5v6'/%3E%3C/svg%3E") !important;
}
html.dark-mode .jstb_img {
  background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='16' height='16' viewBox='0 0 24 24' fill='none' stroke='%23e4e4e7' stroke-width='2' stroke-linecap='round' stroke-linejoin='round'%3E%3Cpath d='M15 8h.01'/%3E%3Cpath d='M3 6a3 3 0 0 1 3 -3h12a3 3 0 0 1 3 3v12a3 3 0 0 1 -3 3h-12a3 3 0 0 1 -3 -3v-12z'/%3E%3Cpath d='M3 16l5 -5c.928 -.893 2.072 -.893 3 0l5 5'/%3E%3Cpath d='M14 14l1 -1c.928 -.893 2.072 -.893 3 0l3 3'/%3E%3C/svg%3E") !important;
}
html.dark-mode .jstb_table {
  background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='16' height='16' viewBox='0 0 24 24' fill='none' stroke='%23e4e4e7' stroke-width='2' stroke-linecap='round' stroke-linejoin='round'%3E%3Cpath d='M12.5 21h-7.5a2 2 0 0 1 -2 -2v-14a2 2 0 0 1 2 -2h14a2 2 0 0 1 2 2v7.5'/%3E%3Cpath d='M3 10h18'/%3E%3Cpath d='M10 3v18'/%3E%3Cpath d='M16 19h6'/%3E%3Cpath d='M19 16v6'/%3E%3C/svg%3E") !important;
}
html.dark-mode .jstb_help {
  background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='16' height='16' viewBox='0 0 24 24' fill='none' stroke='%23e4e4e7' stroke-width='2' stroke-linecap='round' stroke-linejoin='round'%3E%3Cpath d='M12 12m-9 0a9 9 0 1 0 18 0a9 9 0 1 0 -18 0'/%3E%3Cpath d='M12 17l0 .01'/%3E%3Cpath d='M12 13.5a1.5 1.5 0 0 1 1 -1.5a2.6 2.6 0 1 0 -3 -4'/%3E%3C/svg%3E") !important;
}
html.dark-mode .jstb_tl {
  background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='16' height='16' viewBox='0 0 24 24' fill='none' stroke='%23e4e4e7' stroke-width='2' stroke-linecap='round' stroke-linejoin='round'%3E%3Cpath d='M13 5h8'/%3E%3Cpath d='M13 9h5'/%3E%3Cpath d='M13 15h8'/%3E%3Cpath d='M13 19h5'/%3E%3Cpath d='M3 4m0 1a1 1 0 0 1 1 -1h4a1 1 0 0 1 1 1v4a1 1 0 0 1 -1 1h-4a1 1 0 0 1 -1 -1z'/%3E%3Cpath d='M3 14m0 1a1 1 0 0 1 1 -1h4a1 1 0 0 1 1 1v4a1 1 0 0 1 -1 1h-4a1 1 0 0 1 -1 -1z'/%3E%3C/svg%3E") !important;
}

/* Tabs in editor (Edit/Preview) */
html.dark-mode .tabs-buttons {
  background-color: var(--dm-bg-secondary) !important;
}

html.dark-mode ul.tabs {
  background-color: transparent !important;
}

html.dark-mode ul.tabs li a {
  background-color: var(--dm-bg-secondary) !important;
  border: 1px solid var(--dm-border) !important;
  color: var(--dm-text-primary) !important;
}

html.dark-mode ul.tabs li a:hover {
  background-color: var(--dm-bg-hover) !important;
}

html.dark-mode ul.tabs li a.selected {
  background-color: var(--dm-bg-primary) !important;
  border-bottom-color: var(--dm-bg-primary) !important;
  color: var(--dm-text-primary) !important;
}

/* ============================================
   CALENDAR - FIXED
   ============================================ */
html.dark-mode table.cal {
  border: 1px solid var(--dm-border) !important;
  background-color: var(--dm-bg-primary) !important;
}

html.dark-mode table.cal thead th {
  background-color: var(--dm-table-header) !important;
  color: var(--dm-text-primary) !important;
  border: 1px solid var(--dm-border) !important;
  padding: 8px !important;
}

html.dark-mode table.cal tbody td {
  background-color: var(--dm-bg-primary) !important;
  border: 1px solid var(--dm-border) !important;
  color: var(--dm-text-primary) !important;
  vertical-align: top !important;
}

html.dark-mode table.cal tbody td.odd {
  background-color: var(--dm-bg-secondary) !important;
}

html.dark-mode table.cal tbody td.today {
  background-color: rgba(251, 191, 36, 0.15) !important;
}

html.dark-mode table.cal tbody td.nwday {
  background-color: var(--dm-bg-card) !important;
}

/* Calendar day numbers */
html.dark-mode table.cal td p.day-num {
  color: var(--dm-text-primary) !important;
  font-weight: bold !important;
}

html.dark-mode table.cal td.odd p.day-num {
  color: var(--dm-text-secondary) !important;
}

/* Calendar week numbers */
html.dark-mode table.cal td.week-number {
  background-color: var(--dm-bg-secondary) !important;
  color: var(--dm-text-muted) !important;
}

/* Calendar issue links */
html.dark-mode table.cal a.issue {
  color: var(--dm-link) !important;
}

html.dark-mode table.cal span.icon {
  color: var(--dm-text-primary) !important;
}

/* Calendar navigation */
html.dark-mode .calendar-nav {
  color: var(--dm-text-primary) !important;
}

/* Small calendar / datepicker in sidebar */
html.dark-mode table.cal.mini th,
html.dark-mode table.cal.mini td {
  color: var(--dm-text-primary) !important;
}

/* ============================================
   FIELDSET AND LEGEND - IMPROVED
   ============================================ */
html.dark-mode fieldset {
  background-color: var(--dm-bg-card) !important;
  border: 1px solid var(--dm-border) !important;
}

html.dark-mode fieldset.collapsible legend {
  color: var(--dm-text-primary) !important;
}

html.dark-mode fieldset.collapsible legend:hover {
  color: var(--dm-link) !important;
}

/* ============================================
   ISSUE FORM SPECIFIC FIXES
   ============================================ */
html.dark-mode #issue-form .box {
  background-color: var(--dm-bg-card) !important;
}

html.dark-mode #issue-form p {
  color: var(--dm-text-primary) !important;
}

html.dark-mode #issue-form label {
  color: var(--dm-text-primary) !important;
}

html.dark-mode .splitcontent {
  color: var(--dm-text-primary) !important;
}

/* Watchers checkboxes list */
html.dark-mode #watchers_form label {
  color: var(--dm-text-primary) !important;
}

/* File upload area */
html.dark-mode .attachments_form {
  color: var(--dm-text-primary) !important;
}

html.dark-mode span.add_attachment {
  color: var(--dm-text-primary) !important;
}
